@{
    var modelMetadata = ViewData.ModelMetadata;
    RelationScaffolding.RelationOne2OneAttribute relationAttribute = modelMetadata.ContainerType.GetMembers().FirstOrDefault(x => x.Name == modelMetadata.PropertyName).GetCustomAttributes(typeof(RelationScaffolding.RelationOne2OneAttribute), false).FirstOrDefault() as RelationScaffolding.RelationOne2OneAttribute;
    var lookup = new RelationScaffolding.RelationHelper(ViewData).GetLookup();

    ViewData.TemplateInfo.HtmlFieldPrefix = string.Empty;

    var propertyName = modelMetadata.PropertyName;
    if (ViewData["ShortcutProperty"] == null || (bool)ViewData["ShortcutProperty"] == false)
    {
        propertyName += ".";
    }

    propertyName += lookup.KeyMemberInfo.Name;

    // Bug with DropDownList, we must copy the value in the ViewData
    ViewData[modelMetadata.PropertyName] = lookup.SelectedObjectKey;
}

@Html.DropDownList((string)propertyName, new System.Web.Mvc.SelectList((System.Collections.IEnumerable)ViewData["list"] ?? new System.Collections.ObjectModel.Collection<object>(), lookup.KeyMemberInfo.Name, lookup.DisplayMemberInfo.Name, lookup.SelectedObjectKey), relationAttribute.Empty, (object)ViewData["htmlAttributes"])